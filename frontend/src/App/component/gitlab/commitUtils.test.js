import { countCommitsByTeam, countCommitsByMember } from './commitUtils';

let commitData = [
  {
    id: '14f2acdd8022dc651dc67497ba783565c508f6af',
    short_id: '14f2acdd',
    created_at: '2020-10-17T20:05:07.000+08:00',
    parent_ids: ['5c54eb812bfe20ab1ca6244c72d5aa9212848d4b'],
    title: 'add composer.lock & heroku procfile',
    message: 'add composer.lock & heroku procfile\n',
    author_name: 'changken',
    author_email: 'pp24513@gmail.com',
    authored_date: '2020-10-17T20:05:07.000+08:00',
    committer_name: 'changken',
    committer_email: 'pp24513@gmail.com',
    committed_date: '2020-10-17T20:05:07.000+08:00',
    trailers: {},
    web_url:
      'https://gitlab.com/changken/changken-wallet/-/commit/14f2acdd8022dc651dc67497ba783565c508f6af',
    stats: {
      additions: 7732,
      deletions: 2,
      total: 7734,
    },
  },
  {
    id: '5c54eb812bfe20ab1ca6244c72d5aa9212848d4b',
    short_id: '5c54eb81',
    created_at: '2019-01-11T22:04:31.000+08:00',
    parent_ids: ['40a29e0ccfb37cd6f2d745c62be1aa970af3168f'],
    title: '升級成laravel 5.7',
    message: '升級成laravel 5.7\n\n我想架構的部分應該是還沒有完成的!\n',
    author_name: 'changkenkai',
    author_email: 'pp24513@gmail.com',
    authored_date: '2019-01-11T22:04:31.000+08:00',
    committer_name: 'changkenkai',
    committer_email: 'pp24513@gmail.com',
    committed_date: '2019-01-11T22:04:31.000+08:00',
    trailers: {},
    web_url:
      'https://gitlab.com/changken/changken-wallet/-/commit/5c54eb812bfe20ab1ca6244c72d5aa9212848d4b',
    stats: {
      additions: 584,
      deletions: 370,
      total: 954,
    },
  },
  {
    id: '40a29e0ccfb37cd6f2d745c62be1aa970af3168f',
    short_id: '40a29e0c',
    created_at: '2018-07-26T19:30:19.000+08:00',
    parent_ids: ['0313739a4d9ddb521f970cfea1b8b0d0caa0497d'],
    title: '將架構重寫',
    message: '將架構重寫\n\n如題，尚未全部完成...\n',
    author_name: 'changkenkai',
    author_email: 'pp24513@gmail.com',
    authored_date: '2018-07-26T19:30:19.000+08:00',
    committer_name: 'changkenkai',
    committer_email: 'pp24513@gmail.com',
    committed_date: '2018-07-26T19:30:19.000+08:00',
    trailers: {},
    web_url:
      'https://gitlab.com/changken/changken-wallet/-/commit/40a29e0ccfb37cd6f2d745c62be1aa970af3168f',
    stats: {
      additions: 647,
      deletions: 332,
      total: 979,
    },
  },
  {
    id: '0313739a4d9ddb521f970cfea1b8b0d0caa0497d',
    short_id: '0313739a',
    created_at: '2018-07-25T20:58:40.000+08:00',
    parent_ids: ['a2aab7ec19413a6f8c932e925851dcd74d711274'],
    title: '從laravel5.5升級到5.6',
    message: '從laravel5.5升級到5.6\n\n也順便將bootstrap 3.3.7升級到4.1.1\n',
    author_name: 'changkenkai',
    author_email: 'pp24513@gmail.com',
    authored_date: '2018-07-25T20:58:40.000+08:00',
    committer_name: 'changkenkai',
    committer_email: 'pp24513@gmail.com',
    committed_date: '2018-07-25T20:58:40.000+08:00',
    trailers: {},
    web_url:
      'https://gitlab.com/changken/changken-wallet/-/commit/0313739a4d9ddb521f970cfea1b8b0d0caa0497d',
    stats: {
      additions: 22473,
      deletions: 10408,
      total: 32881,
    },
  },
  {
    id: 'a2aab7ec19413a6f8c932e925851dcd74d711274',
    short_id: 'a2aab7ec',
    created_at: '2018-04-01T20:42:41.000+08:00',
    parent_ids: [],
    title: 'first commit',
    message: 'first commit\n',
    author_name: 'changken',
    author_email: 'pp24513@gmail.com',
    authored_date: '2018-04-01T20:42:41.000+08:00',
    committer_name: 'changken',
    committer_email: 'pp24513@gmail.com',
    committed_date: '2018-04-01T20:42:41.000+08:00',
    trailers: {},
    web_url:
      'https://gitlab.com/changken/changken-wallet/-/commit/a2aab7ec19413a6f8c932e925851dcd74d711274',
    stats: {
      additions: 22177,
      deletions: 0,
      total: 22177,
    },
  },
];

let startMonth = '2018-01';
let endMonth = '2022-01';
let numberOfMember = 5;

test('test countCommitsByTeam function', () => {
  let chartDataset = countCommitsByTeam(commitData, startMonth, endMonth);
  expect(chartDataset).toEqual({
    labels: [
      '2018-01',
      '2018-02',
      '2018-03',
      '2018-04',
      '2018-05',
      '2018-06',
      '2018-07',
      '2018-08',
      '2018-09',
      '2018-10',
      '2018-11',
      '2018-12',
      '2019-01',
      '2019-02',
      '2019-03',
      '2019-04',
      '2019-05',
      '2019-06',
      '2019-07',
      '2019-08',
      '2019-09',
      '2019-10',
      '2019-11',
      '2019-12',
      '2020-01',
      '2020-02',
      '2020-03',
      '2020-04',
      '2020-05',
      '2020-06',
      '2020-07',
      '2020-08',
      '2020-09',
      '2020-10',
      '2020-11',
      '2020-12',
      '2021-01',
      '2021-02',
      '2021-03',
      '2021-04',
      '2021-05',
      '2021-06',
      '2021-07',
      '2021-08',
      '2021-09',
      '2021-10',
      '2021-11',
      '2021-12',
      '2022-01',
    ],
    data: {
      team: [
        0, 0, 0, 1, 0, 0, 2, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0,
      ],
    },
  });
});

test('test countCommitsByMember function', () => {
  let chartDataset = countCommitsByMember(
    commitData,
    startMonth,
    endMonth,
    numberOfMember
  );
  expect(chartDataset).toEqual({
    labels: [
      '2018-01',
      '2018-02',
      '2018-03',
      '2018-04',
      '2018-05',
      '2018-06',
      '2018-07',
      '2018-08',
      '2018-09',
      '2018-10',
      '2018-11',
      '2018-12',
      '2019-01',
      '2019-02',
      '2019-03',
      '2019-04',
      '2019-05',
      '2019-06',
      '2019-07',
      '2019-08',
      '2019-09',
      '2019-10',
      '2019-11',
      '2019-12',
      '2020-01',
      '2020-02',
      '2020-03',
      '2020-04',
      '2020-05',
      '2020-06',
      '2020-07',
      '2020-08',
      '2020-09',
      '2020-10',
      '2020-11',
      '2020-12',
      '2021-01',
      '2021-02',
      '2021-03',
      '2021-04',
      '2021-05',
      '2021-06',
      '2021-07',
      '2021-08',
      '2021-09',
      '2021-10',
      '2021-11',
      '2021-12',
      '2022-01',
    ],
    data: {
      changkenkai: [
        0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0,
      ],
      changken: [
        0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0,
      ],
    },
  });
});
