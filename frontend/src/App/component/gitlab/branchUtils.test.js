import { locateBranchLastCommittedAt } from './branchUtils';

let branchData = [
  {
    name: 'dev',
    commit: {
      id: '5c54eb812bfe20ab1ca6244c72d5aa9212848d4b',
      short_id: '5c54eb81',
      created_at: '2019-01-11T14:04:31.000+00:00',
      parent_ids: null,
      title: '升級成laravel 5.7',
      message: '升級成laravel 5.7',
      author_name: 'changkenkai',
      author_email: 'pp24513@gmail.com',
      authored_date: '2019-01-11T14:04:31.000+00:00',
      committer_name: 'changkenkai',
      committer_email: 'pp24513@gmail.com',
      committed_date: '2019-01-11T14:04:31.000+00:00',
      trailers: null,
      web_url:
        'https://gitlab.com/changken/changken-wallet/-/commit/5c54eb812bfe20ab1ca6244c72d5aa9212848d4b',
    },
    merged: true,
    protected: false,
    developers_can_push: false,
    developers_can_merge: false,
    can_push: true,
    default: false,
    web_url: 'https://gitlab.com/changken/changken-wallet/-/tree/dev',
  },
  {
    name: 'master',
    commit: {
      id: '14f2acdd8022dc651dc67497ba783565c508f6af',
      short_id: '14f2acdd',
      created_at: '2020-10-17T12:05:07.000+00:00',
      parent_ids: null,
      title: 'add composer.lock & heroku procfile',
      message: 'add composer.lock & heroku procfile',
      author_name: 'changken',
      author_email: 'pp24513@gmail.com',
      authored_date: '2020-10-17T12:05:07.000+00:00',
      committer_name: 'changken',
      committer_email: 'pp24513@gmail.com',
      committed_date: '2020-10-17T12:05:07.000+00:00',
      trailers: null,
      web_url:
        'https://gitlab.com/changken/changken-wallet/-/commit/14f2acdd8022dc651dc67497ba783565c508f6af',
    },
    merged: false,
    protected: true,
    developers_can_push: false,
    developers_can_merge: false,
    can_push: true,
    default: true,
    web_url: 'https://gitlab.com/changken/changken-wallet/-/tree/master',
  },
];

let startMonth = '2018-01';
let endMonth = '2022-01';

test('test locateBranchLastCommittedAt function', () => {
  let chartDataset = locateBranchLastCommittedAt(
    branchData,
    startMonth,
    endMonth
  );
  expect(chartDataset).toEqual({
    labels: [
      '2018-01',
      '2018-02',
      '2018-03',
      '2018-04',
      '2018-05',
      '2018-06',
      '2018-07',
      '2018-08',
      '2018-09',
      '2018-10',
      '2018-11',
      '2018-12',
      '2019-01',
      '2019-02',
      '2019-03',
      '2019-04',
      '2019-05',
      '2019-06',
      '2019-07',
      '2019-08',
      '2019-09',
      '2019-10',
      '2019-11',
      '2019-12',
      '2020-01',
      '2020-02',
      '2020-03',
      '2020-04',
      '2020-05',
      '2020-06',
      '2020-07',
      '2020-08',
      '2020-09',
      '2020-10',
      '2020-11',
      '2020-12',
      '2021-01',
      '2021-02',
      '2021-03',
      '2021-04',
      '2021-05',
      '2021-06',
      '2021-07',
      '2021-08',
      '2021-09',
      '2021-10',
      '2021-11',
      '2021-12',
      '2022-01',
    ],
    data: {
      dev: [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0,
      ],
      master: [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0,
      ],
    },
  });
});
